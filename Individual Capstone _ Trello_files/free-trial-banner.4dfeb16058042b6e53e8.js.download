(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{"./app/src/components/FreeTrial/FreeTrialBanner.less":function(e,n,a){var t=a("./node_modules/css-loader/index.js?!./node_modules/postcss-loader/src/index.js?!./node_modules/less-loader/dist/cjs.js?!./app/src/components/FreeTrial/FreeTrialBanner.less");"string"==typeof t&&(t=[[e.i,t,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};a("./node_modules/style-loader/lib/addStyles.js")(t,r);t.locals&&(e.exports=t.locals)},"./app/src/components/FreeTrial/index.ts":function(e,n,a){"use strict";a.r(n),a.d(n,"UpsellOverlay",(function(){return t.a})),a.d(n,"FreeTrialBanner",(function(){return M})),a.d(n,"PlanSelectionType",(function(){return y.PlanSelectionType})),a.d(n,"PlanSelectionOverlay",(function(){return y.PlanSelectionOverlay})),a.d(n,"useFreeTrialEligibilityRules",(function(){return _.a}));var t=a("./app/src/components/FreeTrial/UpsellOverlay.tsx"),r=a("./node_modules/react/index.js"),o=a.n(r),i=a("./node_modules/classnames/index.js"),s=a.n(i),l=a("./packages/config/index.ts"),c=a("./packages/nachos/index.ts"),d=a("./node_modules/js-cookie/src/js.cookie.js"),u=a.n(d),m=a("./app/common/components/controls/icon/index.tsx"),p=a("./packages/dates/index.ts"),f=a("./app/common/lib/util/i18n/index.ts"),g=a("./packages/graphql/generated.tsx"),b=a("./app/src/components/FreeTrial/FreeTrialBanner.less"),v=a.n(b),y=a("./app/src/components/FreeTrial/PlanSelection.tsx"),x=a("./packages/atlassian-analytics/index.ts"),_=a("./app/src/components/FreeTrial/useFreeTrialEligibilityRules.ts"),h=a("./node_modules/canvas-confetti/dist/confetti.module.mjs"),j=a("./node_modules/underscore/underscore.js"),k=a.n(j),T=a("./app/src/components/ErrorBoundary/ErrorBoundary.tsx"),w=a("./app/scripts/debug/constants.ts"),B=a("./packages/webdriverio-tests/index.ts"),E=a("./app/common/components/singlespa/router-link.tsx");function N(e,n,a,t,r,o,i){try{var s=e[o](i),l=s.value}catch(e){return void a(e)}s.done?n(l):Promise.resolve(l).then(t,r)}function C(e){return function(){var n=this,a=arguments;return new Promise((function(t,r){var o=e.apply(n,a);function i(e){N(o,t,r,i,s,"next",e)}function s(e){N(o,t,r,i,s,"throw",e)}i(void 0)}))}}function F(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],t=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(t=(i=s.next()).done)&&(a.push(i.value),!n||a.length!==n);t=!0);}catch(e){r=!0,o=e}finally{try{t||null==s.return||s.return()}finally{if(r)throw o}}return a}(e,n)||function(e,n){if(!e)return;if("string"==typeof e)return S(e,n);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(a);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return S(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,n){(null==n||n>e.length)&&(n=e.length);for(var a=0,t=new Array(n);a<n;a++)t[a]=e[a];return t}var O=Object(f.forNamespace)("free trial existing"),M=function(e){var n,a,t,i,d,b,j,N=e.orgId,S=F(Object(r.useState)(!1),2),M=S[0],A=S[1],R=function(){return A(!0)},I="free-trial-banner-".concat(N),P="free-trial-banner-confetti-".concat(N),z=F(Object(g.qb)(),1)[0],V=Object(_.a)(N),G=V.isTrialActive,X=V.freeTrialCredit,q=V.isAdmin,D=Object(g.pb)({variables:{orgId:N}}),U=D.data,W=D.loading,H=(null==U||null===(n=U.member)||void 0===n?void 0:n.oneTimeMessagesDismissed)?null==U||null===(a=U.member)||void 0===a?void 0:a.oneTimeMessagesDismissed:[],Z=F(Object(r.useState)(0),2),L=Z[0],J=Z[1],K=F(Object(r.useState)(0),2),Q=K[0],Y=K[1],$=Object(r.useCallback)((function(){z({variables:{memberId:"me",messageId:P},optimisticResponse:{__typename:"Mutation",addOneTimeMessagesDismissed:{id:"me",oneTimeMessagesDismissed:H.concat([P]),__typename:"Member"}}})}),[H,z,P]),ee=H.includes(P);Object(r.useEffect)((function(){L&&Q&&!W&&!ee&&(Object(h.default)({angle:k.a.random(0,45),spread:k.a.random(150,180),particleCount:150,origin:{x:0,y:Q/window.innerHeight}}),$())}),[L,Q,W,ee,$]);var ne=Object(r.useCallback)((function(e){if(null!==e){var n=e.getBoundingClientRect();J(n.x+n.width/2),Y(n.y+n.height/2)}ee&&h.default.reset()}),[ee]),ae=null==U||null===(t=U.organization)||void 0===t?void 0:t.displayName,te=null==U||null===(i=U.organization)||void 0===i?void 0:i.name,re=te?"/".concat(te,"/billing"):"",oe=null==U||null===(d=U.organization)||void 0===d||null===(b=d.paidAccount)||void 0===b?void 0:b.canRenew;if(!X||H.includes(I)||W||(null==U||null===(j=U.organization)||void 0===j?void 0:j.idEnterprise)||l.dontUpsell)return null;var ie=Object(p.c)(X.id),se=X.count,le=ie.setDate(ie.getDate()+se),ce=le&&Object(p.a)(new Date,new Date(le),!0),de=Math.ceil(ce),ue=u.a.get("simulateExpiredTrial"),me=G&&!ue,pe=30===(null==X?void 0:X.count),fe=function(){var e=C(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=q&&me?"admin":me?"normal":"expired",x.Analytics.sendViewedBannerEvent({bannerName:"freeTrialBanner",source:Object(x.getScreenFromUrl)(),containers:{organization:{id:N}},attributes:{type:n}});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ge=s()(v.a.container,me?v.a.bannerBg:v.a.expiredBg),be=function(){var e=C(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:x.Analytics.sendDismissedComponentEvent({componentType:"banner",componentName:"freeTrialBanner",source:Object(x.getScreenFromUrl)(),containers:{organization:{id:N}}}),z({variables:{memberId:"me",messageId:I},optimisticResponse:{__typename:"Mutation",addOneTimeMessagesDismissed:{id:"me",oneTimeMessagesDismissed:H.concat([I]),__typename:"Member"}}});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ve=function(){var e=q&&me?"addPaymentButton":"upgradeButton";x.Analytics.sendClickedButtonEvent({buttonName:e,source:"freeTrialBanner",containers:{organization:{id:N}}})};if(!q&&!me||q&&pe)return null;fe();return o.a.createElement(T.a,{tags:{ownershipArea:"trello-bizteam",feature:w.Feature.FreeTrialExistingTeam}},o.a.createElement("div",{className:ge},o.a.createElement("div",{className:v.a.bcContainer},me?o.a.createElement(o.a.Fragment,null,o.a.createElement("span",{role:"img","aria-label":"confetti",className:v.a.emoji},"ðŸŽ‰"),Object(f.localizeCount)("free-trial-banner-tagline-by-days",de,{teamName:o.a.createElement(o.a.Fragment,{key:ae},ae),days:o.a.createElement("div",{ref:ne,key:"".concat(ae,"-").concat(de),className:v.a.daysContainer},de)})):o.a.createElement(o.a.Fragment,null,o.a.createElement("span",{role:"img","aria-label":"wave",className:v.a.emoji},"ðŸ‘‹"),O(["banner","expired tagline"],{teamName:o.a.createElement(o.a.Fragment,{key:ae},ae)}))),o.a.createElement("div",{className:v.a.ctaContainer},me?o.a.createElement(o.a.Fragment,null,q&&!oe?o.a.createElement(o.a.Fragment,null,o.a.createElement("a",{role:"button",className:v.a.learnMoreCta,onClick:function(){x.Analytics.sendClickedLinkEvent({linkName:"learnMoreLink",source:"freeTrialBanner",containers:{organization:{id:N}}}),R()}},Object(f.forNamespace)("learn more button")("")),o.a.createElement(E.a,{className:v.a.linkButton,href:re,onClick:ve,"data-test-id":B.FreeTrialTestIds.BannerAddPaymentButton},O(["banner","add-payment-method"]))):o.a.createElement(o.a.Fragment,null,o.a.createElement(c.Button,{className:v.a.button,appearance:"primary",onClick:function(){x.Analytics.sendClickedButtonEvent({buttonName:"learnMoreButton",source:"freeTrialBanner",containers:{organization:{id:N}}}),R()}},Object(f.forNamespace)("learn more button")("")),o.a.createElement("button",{className:v.a.closeButton,onClick:be},o.a.createElement(m.default,{className:v.a.closeIcon,name:m.IconName.Close,medium:!0})))):o.a.createElement(o.a.Fragment,null,o.a.createElement(E.a,{className:v.a.linkButton,href:re,onClick:function(){be(),ve()}},O(["banner","add-payment-method"])),o.a.createElement("button",{className:v.a.closeButton,onClick:be},o.a.createElement(m.default,{className:v.a.closeIcon,name:m.IconName.Close,medium:!0}))))),M&&o.a.createElement(y.PlanSelectionOverlay,{orgId:N,onContinue:function(){},onClose:function(){return A(!1)},trialLength:X.count}))}},"./node_modules/css-loader/index.js?!./node_modules/postcss-loader/src/index.js?!./node_modules/less-loader/dist/cjs.js?!./app/src/components/FreeTrial/FreeTrialBanner.less":function(e,n,a){(n=e.exports=a("./node_modules/css-loader/lib/css-base.js")(!1)).push([e.i,"._3QfNAnBeb5MXCS{padding:0 4px 0 16px;height:40px;background-color:rgba(9,30,66,.95);display:flex;align-items:center;justify-content:space-between;line-height:18px;font-weight:600}._5PgQi1bn-4l3qI{margin-right:8px}._1_uAu9Z6xjwuz9{color:#fff;background-color:rgba(9,30,66,.95)}._1qjssZ1iwLuaP5{color:#172b4d;background-color:#d6ecd2}._1ta38j4GmHUsTw{display:flex;flex-direction:row;align-items:center}.WMV_Nnak6jlW5q{display:flex;justify-content:center;align-items:center;background-color:#42526e;border-radius:3px;width:24px;height:24px;margin:0 4px}._8xBegbhXb5B02c{display:flex;flex-direction:row}._1XazycWMJxPXZ7{color:#a5adba;display:flex;align-items:center;margin-right:8px;-webkit-text-decoration-line:underline;text-decoration-line:underline;font-size:12px;line-height:16px;font-weight:500;cursor:pointer}._1XazycWMJxPXZ7:hover{color:#fff}._2T9VGoSVwTCClN{color:#172b4d}._3Ma7XvbkR__6ZG{margin:0}._2ifWmVmmvSBRpK{-webkit-text-decoration-line:none;text-decoration-line:none;font-size:14px;line-height:20px;font-weight:400;margin:0;background-color:#5aac44;color:#fff;padding:6px 12px;border-radius:3px;transition:background .1s ease-out,box-shadow .15s cubic-bezier(.47,.03,.49,1.38);transition-duration:.1s,.15s}._2ifWmVmmvSBRpK:hover{background-color:#61bd4f;color:#fff}._2ifWmVmmvSBRpK:active{background-color:#49852e;color:#fff}._1v8GVHyNTRAG1m{margin:0;padding:0}._1v8GVHyNTRAG1m,._1v8GVHyNTRAG1m:hover{background-color:transparent}._1a2N7Y8vuH0tha{margin-left:2px;color:#42526e}._1a2N7Y8vuH0tha:hover{color:#fff}._1SLq6R5EvPUlFj{margin-left:2px;color:#6b778c}._1SLq6R5EvPUlFj:hover{color:#42526e}",""]),n.locals={container:"_3QfNAnBeb5MXCS",emoji:"_5PgQi1bn-4l3qI",bannerBg:"_1_uAu9Z6xjwuz9",expiredBg:"_1qjssZ1iwLuaP5",bcContainer:"_1ta38j4GmHUsTw",daysContainer:"WMV_Nnak6jlW5q",ctaContainer:"_8xBegbhXb5B02c",learnMoreCta:"_1XazycWMJxPXZ7",sendFeedbackCta:"_2T9VGoSVwTCClN",button:"_3Ma7XvbkR__6ZG",linkButton:"_2ifWmVmmvSBRpK",closeButton:"_1v8GVHyNTRAG1m",closeIcon:"_1a2N7Y8vuH0tha",expiredCloseIcon:"_1SLq6R5EvPUlFj"}}}]);
//# sourceMappingURL=free-trial-banner.4dfeb16058042b6e53e8.js.map